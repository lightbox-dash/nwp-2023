<div><div class="d-flex flex-grow-1 w-100 h-100" plug="content"><style type="text/css">.final-result{background:#f1f2f3;color:rgba(112,112,112,0)}.final-result.accept{background:#28a745;color:#fff}.final-result.overflow.accept{border-left:10px solid #f90}.prj{width:fit-content;min-width:100%}.prj.lockdown{background:#ff9}.prj.highlight{background:#9ff}.prj.disabled{filter:saturate(0);background:#edeeef;color:#777879}.prj.disabled .clickable{cursor:not-allowed !important}.prj.disabled.hidden{display:none !important}.dropdown-item{display:flex;justify-content:space-between}.dropdown-item[ld="all-sort-method"] i{opacity:0}.dropdown-item.active[ld="all-sort-method"] i{opacity:1}.judge-cells{gap:1px}.sticky .judge-cells>div:nth-child(2n){border-bottom:3px solid rgba(0,0,0,0.05)}.sticky .judge-cells>div:nth-child(2n+1){border-bottom:3px solid rgba(0,0,0,0.25)}.prj .judge-cells{color:#999}.prj .judge-cells>div{border-radius:.1em;display:flex;height:100%;align-items:center;justify-content:center}.prj .judge-cells>div:nth-child(2n){background:rgba(0,0,0,0.01)}.prj .judge-cells>div:nth-child(2n+1){background:rgba(0,0,0,0.05)}.prj .judge-cells .highlight{color:#000;font-weight:700}</style><script type="@plotdb/block">var submod;submod={};submod.rule=function(e){var t,r,a,o,n,i=this;t=e.ctx;r={};a=function(){return((i.data||{}).cfg||{}).rule||{}};o=function(){var e;if(!(e=a()["threshold-ticket"])){return 0}else{return e}};n={init:{dropdown:function(e){var t;t=e.node;return new BSN.Dropdown(t)}},action:{click:{"toggle-weighting":function(){return i.tool["judge-weighting"].view.apply(i.mod,arguments)},switch:function(e){var t,r,n,u;t=e.node;r=t.getAttribute("data-name");((n=(u=i.data).cfg||(u.cfg={})).rule||(n.rule={}))[r]=!((n=(u=i.data).cfg||(u.cfg={})).rule||(n.rule={}))[r];i.update();return i.render()}},input:{"threshold-ticket":function(e){var t,r,n,u,a;t=e.node;((r=(n=(u=i.data).cfg||(u.cfg={})).rule||(n.rule={})).raw||(r.raw={}))["threshold-ticket"]=a=t.value;if(isNaN(+a)||(a+"").trim()===""){a=NaN}((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={}))["threshold-ticket"]=a;i.update();return i.render()},"point-quota":function(e){var t,r,n;t=e.node;((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={}))["point-quota"]=isNaN(+t.value)?0:+t.value;i.update();return i.render()},"max-ticket":function(e){var t,r,n;t=e.node;((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={}))["max-ticket"]=isNaN(+t.value)?0:+t.value;i.update();return i.render()},"picked-count":function(e){var t,r,n;t=e.node;((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={}))["picked-count"]=isNaN(+t.value)?0:+t.value;i.update();return i.render()}},change:{"base-rule":function(e){var t,r,n;t=e.node;((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={})).base=t.value;i.update();return i.render()},"pt-ratio":function(e){var t,r,n;t=e.node;((r=(n=i.data).cfg||(n.cfg={})).rule||(r.rule={}))["pt-ratio"]=t.value||"linear";i.update();return i.render()}}},handler:{switch:function(e){var t;t=e.node;return t.classList.toggle("on",!!a()[t.getAttribute("data-name")])},"show-threshold-ticket":function(e){var t,r,n,u;t=e.node;r=a();n=o();u=(r.raw||{})["threshold-ticket"];return t.classList.toggle("d-none",n===u)},"threshold-ticket":function(e){var t;t=e.node;return t.value=t.innerText=o()},"max-ticket":function(e){var t;t=e.node;return t.value=a()["max-ticket"]||0},"point-quota":function(e){var t;t=e.node;return t.value=a()["point-quota"]||1},"picked-count":function(e){var t;t=e.node;return t.value=a()["picked-count"]||0},"base-rule":function(e){var t;t=e.node;return t.value=a().base||"t"},"pt-ratio":function(e){var t;t=e.node;return t.value=a()["pt-ratio"]||"linear"}},text:{"weighted-value":function(){var e;e=a();if(e["weighted"]){return"啟用"}else{return"未啟用"}},"comment-optional-value":function(){var e;e=a();if(e["comment-optional"]){return"選填"}else{return"必填"}}}};return{obj:r,view:n}};submod.monitor=function(t){var n,e,r,o=this;n=t.ctx;e=function(){return o.judge.users.map(function(e){var t,r;t={judge:e,value:r={}};o.prjs.map(function(t){var n;n=(((o.data.user||{})[e.key]||{}).prj||{})[t.key];if(n.avoid){return}r.count=(r.count||0)+1;if(n.comment){r.comment=(r.comment||0)+1}if(n.v!=null){return r.score=(r.score||0)+1}});return t})};r={handler:{judge:{list:function(){return e()},key:function(t){return t.judge.key},view:{text:{score:function(t){var n;n=t.ctx;return n.value.score||0},comment:function(t){var n;n=t.ctx;return n.value.comment||0},count:function(t){var n;n=t.ctx;return n.value.count||0},"used-point":function(t){var n;n=t.ctx;return((o.data.user||{})[n.judge.key]||{})["used-point"]||0},"total-point":function(t){var n;n=t.ctx;return((o.data.cfg||{}).rule||{})["point-quota"]||1}},handler:{name:function(t){var n,e;n=t.node,e=t.ctx;return n.innerText=e.judge.nickname||e.judge.displayname},"progress-point":function(t){var n,e,r,u;n=t.node,e=t.ctx;r=((o.data.user||{})[e.judge.key]||{})["used-point"]||0;u=((o.data.cfg||{}).rule||{})["point-quota"]||1;return n.style.width=100*r/u+"%"},"progress-comment":function(t){var n,e;n=t.node,e=t.ctx;return n.style.width=100*((e.value.comment||0)/(e.value.count||1))+"%"}}}}}};return{view:r}};submod.download=function(e){var r,n,o,c,t,f=this;r=e.ctx,n=e.t;o=r.csv4xls,c=r.ldfile;t={run:function(){var s,e,p,r,n,t,a,u;s=(f.data.cfg||{}).group||{};e=f.judge.users.map(function(e,r){var n;n=f.judge.form.config.anonymous?"評審"+(r+1):e.nickname||e.displayname;return[n+"票數",n+"評論"]}).reduce(function(e,r){return e.concat(r)},[]);p=false;r=["序位","編號"].concat(s.enabled?["分組"]:[],["名稱","申請單位"],p?["計劃總經費(元)","申請經費(元)","申請經費佔比"]:[],e,["入選標記","會前加註","會中加註"]);r=r.map(function(e){return e+""});n=f.submod.project.utils.filtered().map(function(c){var e,r,n,t,a,u,o,d,i,m;e=f.lib.idx({prj:c});r=f.lib.info({prj:c});n=f.pm.get(c);t=f.judge.users.filter(function(e){var r,n,t,a,u,o;return!((r=(t=(a=(o=f.data).user||(o.user={}))[u=e.key]||(a[u]={})).prj||(t.prj={}))[n=c.key]||(r[n]={})).avoid});a=r.budget.total;u=r.budget["expected-subsidy"];o=(100*(u||0)/(a||1)).toFixed(2);if(isNaN(Number(o))){o="?"}else{o=o+"%"}d=f.getGroup({prj:c}).info.name||"n/a";i=f.resultMark({prj:c});return m=[n.rank,e].concat(s.enabled?[d]:[],[c.name,r.team.name],p?[a,u,o]:[],f.judge.users.map(function(e,r){var n,t,a,u;n=((t=(a=f.data.user)[u=e.key]||(a[u]={})).prj||(t.prj={}))[c.key]||{};return[n.avoid?"(迴避)":n.v||0,n.comment||""]}).reduce(function(e,r){return e.concat(r)},[]),[i.mark,((f.data.prj||{})[c.key]||{}).prenote||"",((f.data.prj||{})[c.key]||{}).note||""])});t=[r].concat(n);a=o.toBlob(t);u=URL.createObjectURL(a);return c.download({blob:a,mime:"text/csv",name:f.judge.form.name+"-"+f.brd.name+".csv"})}};return{obj:t,view:{}}};submod.project=function(t){var e,n,r,s,o,l=this;e=t.ctx,n=t.t;r=e.ldcolor;s=function(t){var e;e=l.data.cfg||{};if(!e["custom-order"]){return false}return!!((e.orders||{})[t.key]||{}).disabled};o=function(t){var e,r,n,o;t==null&&(t={});e=(l.data.cfg||{})["custom-order"];r=(l.data.cfg||{})["hide-disabled"]||t.hide;n=(l.data.cfg||{}).group||{};o=n.entry||{};return l.prjs.filter(function(t){if(n.enabled&&(o[t.grp]||{}).show!=null&&!o[t.grp].show){return false}return!e||!s(t)||!r})};return{utils:{disabled:s,filtered:o},view:{key:function(t){return t.slug},list:function(){return o()},view:{init:{"@":function(t){var e,r;e=t.node,r=t.ctx;return l.pn.set(r,e)}},action:{click:{"custom-id":function(t){var e,r,n;e=t.node,r=t.ctx;n=l.lib.idx({prj:r});l.active["custom-id"]=l.active["custom-id"]===n?null:n;return l.render()},name:function(t){var e,r,n,o,i,c,a;e=t.node,r=t.ctx,n=t.evt;o=(o=((i=(c=l.judge).form||(c.form={})).config||(i.config={})).prjdef)?"/v/"+o:"";a="/prj/"+r.slug+o+"/embed";return window.open(a)},avoid:this.tool.avoid.view}},handler:{"show-group":function(t){var e;e=t.node;return e.classList.toggle("d-none",!((l.data.cfg||{}).group||{}).enabled)},group:function(t){var e,r;e=t.node,r=t.ctx;return e.textContent=n("_local:"+(l.getGroup({prj:r}).info.name||"n/a"))},"@":function(t){var e,r,n,o,i,c,a;e=t.node,r=t.ctx;e.classList.toggle("highlight",!!l.pm.get(r).matched);e.classList.toggle("lockdown",l.active.order===l.pm.get(r).order||l.active["custom-id"]===l.lib.idx({prj:r}));n=s(r);o=(l.data.cfg||{})["hide-disabled"];i=(l.data.cfg||{}).group||{};c=((i.entry||{})[r.grp]||{}).show;a=!!(i.enabled&&(c!=null&&!c));e.classList.toggle("disabled",n||a);return e.classList.toggle("hidden",n&&o||a)},"custom-id":function(t){var e,r;e=t.node,r=t.ctx;e.classList.toggle("font-weight-bold",l.active["custom-id"]===l.lib.idx({prj:r}));return e.innerText=l.lib.idx({prj:r})},idx:function(t){var e,r;e=t.node,r=t.ctx;return e.innerText=l.pm.get(r).order+1},rank:{handler:{"@":function(t){var e,r;e=t.node,r=t.ctxs;return e.classList.toggle("font-weight-bold",l.active.order===l.pm.get(r[0]).order)}},action:{click:{"@":function(t){var e,r;e=t.ctxs;r=l.pm.get(e[0]).order;l.active.order=l.active.order===r?null:r;return l.render()}}},text:{number:function(t){var e;e=t.ctxs;return l.pm.get(e[0]).rank},postfix:function(t){var e,r;e=t.ctxs;r=l.pm.get(e[0]).rank;if((r+"").endsWith("1")){return"st"}else if((r+"").endsWith("2")){return"nd"}else if((r+"").endsWith("3")){return"rd"}else{return"th"}}}},judge:{list:function(){return l.judge.users},key:function(t){return t.key},view:{handler:{ticket:function(t){var e,r,n,o;e=t.node,r=t.ctx,n=t.ctxs;o=((l.data.user||{})[r.key].prj||{})[n[0].key].v||0;e.innerText=o;return e.classList.toggle("highlight",!!o)}}}},result:function(t){var e,r,n,o,i,c,a;e=t.node,r=t.ctx;e.classList.toggle("accept",false);e.classList.toggle("reject",false);e.style.background="";e.style.color="";n=e.querySelector("[ld=icon]");o=l.resultMark({prj:r});i=l.voteMethod();c=l.pm.get(r);if(i==="t"||true){a=o.picked;e.classList.toggle("accept",a);e.classList.toggle("reject",!a);n.setAttribute("class","i-radiobox-off")}e.classList.toggle("overflow",o.overflow);return e.classList.toggle("manual",!o.overflow)},"staff-note":{init:{"@":function(t){var e,r;e=t.node,r=t.local;return r.type=e.getAttribute("data-type")||"note"}},action:{click:{"@":function(t){var e,r,n;e=t.node,r=t.ctxs,n=t.local;return l.tool["staff-note"].view({prj:r[0],type:n.type})}}},handler:{"@":function(t){var e,r,n,o,i,c,a;e=t.node,r=t.ctxs,n=t.local;o=r[0];i=((c=l.data.prj)[a=o.key]||(c[a]={}))[n.type];e.classList.toggle("text-secondary",!i);return e.classList.toggle("text-primary",!!i)},icon:function(t){var e,r,n,o,i,c,a;e=t.node,r=t.ctxs,n=t.local;o=r[0];i=((c=l.data.prj)[a=o.key]||(c[a]={}))[n.type];e.classList.toggle("i-comment",!i);return e.classList.toggle("i-discuss",!!i)}}}},text:{name:function(t){var e,r;e=t.node,r=t.ctx;return l.lib.info({prj:r}).name||n("unnamed")},teamname:function(t){var e;e=t.ctx;return l.lib.info({prj:e}).team.name||n("unnamed")},ticket:function(t){var e;e=t.ctx;return l.pm.get(e).ticket||0},avoid:function(t){var c;c=t.ctx;return l.judge.users.filter(function(t){var e,r,n,o,i;return((e=(n=(o=l.data.user)[i=t.key]||(o[i]={})).prj||(n.prj={}))[r=c.key]||(e[r]={})).avoid}).length}}}}}};module.exports={pkg:{name:"@grantdash/judge",path:"option/all.html",extend:{name:"@grantdash/judge",path:"common"},dependencies:[{name:"ldfile"},{name:"csv4xls"},{name:"ldcolor"},{name:"@loadingio/ldcolorpicker"},{name:"@loadingio/ldcolorpicker",type:"css",global:true}],i18n:{en:{"設定項目":"Options","評分細節":"Detail Result","規則設定":"Rules Setup","簡報順序":"Project Order","選項設定":"Options Setup","結果統計":"Statistics","同分待議":"Tie to Break","未有共識":"No Consensus","入選":"Selected","結果":"Result","總票數":"Ticket"},"zh-TW":{"設定項目":"設定項目","評分細節":"評分細節","規則設定":"規則設定","簡報順序":"簡報順序","選項設定":"選項設定","結果統計":"結果統計","同分待議":"同分待議","未有共識":"未有共識","入選":"入選","結果":"結果","總票數":"總票數"}}},render:function(){var t,e,r,n,i=this;this.statistic();this.view.render();for(t in e=this.renders||{}){r=e[t];r()}if(this.active["custom-id"]){n=this.submod.project.utils.filtered().filter(function(t){return i.active["custom-id"]===i.lib.idx({prj:t})})[0];if(n){this.pn.get(n).scrollIntoView({behavior:"smooth",block:"center"})}}if(this.active.order){n=this.submod.project.utils.filtered().filter(function(t){return i.active.order===i.pm.get(t).order})[0];if(n){return this.pn.get(n).scrollIntoView({behavior:"smooth",block:"center"})}}},statistic:function(){var t,e,r,n,i,o,u,a,l,d,c,f=this;this.prjs.map(function(r){var t,e,n;t=f.pm.get(r);t.ticket=f.judge.users.filter(function(t){return!((((f.data.user||{})[t.key]||{}).prj||{})[r.key]||{}).avoid}).map(function(t){var e;e=((((f.data.user||{})[t.key]||{}).prj||{})[r.key]||{}).v;if(e!=null){return+e}else{return 0}}).reduce(function(t,e){return t+e},0);e=f.voteMethod();n=import$({quota:{enabled:false,count:0},"threshold-ticket":0,compare:"gt"},(f.data.cfg||{}).rule||{});return n.quota.count=isNaN(+n.quota.count)?0:+n.quota.count});t=this.prjs.map(function(t){return{prj:t,stat:f.pm.get(t)}});t.sort(function(t,e){var r,n,i,o,u;r=[t.stat.ticket,e.stat.ticket],n=r[0],i=r[1];if(n>i){return-1}else if(n<i){return 1}r=[f.lib.idx({prj:t.prj}),f.lib.idx({prj:e.prj})],o=r[0],u=r[1];if(o>u){return 1}else if(o<u){return-1}return t.prj.key-e.prj.key});e=[1,((t[0]||{}).stat||{}).ticket||0],r=e[0],n=e[1];i={};for(o=0,u=t.length;o<u;++o){a=o;if(t[a].stat.ticket!==n){e=[a+1,t[a].stat.ticket],r=e[0],n=e[1]}t[a].stat.rank=r;t[a].stat.order=a;i[r]=a+1}for(o=0,u=t.length;o<u;++o){a=o;t[a].stat.countTilRank=i[t[a].stat.rank]}l=this.tool["all-sort"].getMethod();d=function(t,e){var r;r=(f.data.cfg||{}).group||{};if(!(r.enabled&&r.sort)){return 0}return f.groupSorter(f.getGroup({prj:t}),f.getGroup({prj:e}))};if(l==="rank"){this.prjs.sort(function(t,e){var r;if(r=d(t,e)){return r}return f.pm.get(t).order-f.pm.get(e).order})}else if(l==="id"){this.prjs.sort(function(t,e){var r,n;if(r=d(t,e)){return r}n=[f.lib.idx({prj:t}),f.lib.idx({prj:e})],t=n[0],e=n[1];if(t>e){return 1}else if(t<e){return-1}else{return 0}})}else if(l==="custom-order"){c=(this.data.cfg||{}).orders||{};this.prjs.sort(function(t,e){var r,n,i,o,u,a,l,s;if(r=d(t,e)){return r}n=[f.lib.idx({prj:t}),f.lib.idx({prj:e})],i=n[0],o=n[1];u=(c[t.key]||{}).value||undefined;a=(c[e.key]||{}).value||undefined;if(!isNaN(+u)){u=+u}if(!isNaN(+a)){a=+a}l=(c[t.key]||{}).disabled;s=(c[e.key]||{}).disabled;if(!l!==!s&&(l||s)){return l?1:-1}if(!(u!=null||a!=null)){return i<o?-1:i>o?1:0}if(!(u!=null)){return 1}if(!(a!=null)){return-1}return u<a?-1:u>a?1:0})}return t.map(function(t){var e,r,n,i;e=t.prj,r=t.stat;n=f._voteResult(r);r.picked=n;i=((f.data.cfg||{}).rule||{})["picked-count"]||0;if(i&&r.rank>i){return r.picked=false}})},init:function(t){var e,r,n,o,a,i,l=this;e=t.root,r=t.ctx,n=t.manager,o=t.pubsub,a=t.t;i=r.ldcolor;return servebase.corectx(function(t){var i;i=t.core;l.ldcvmgr=i.ldcvmgr;l._normalizeThreshold=function(t){var e;if(t==null||isNaN(+t)){return.5}else{return+((e=t>0?t:0)<1?e:1).toFixed(3)}};l._voteResult=function(t){var e,r;e=this._normalizeThreshold(((this.data.cfg||{}).rule||{}).threshold);r=((this.data.cfg||{}).rule||{})["threshold-ticket"]||0;return t.ticket>=r?true:false};l.resultMark=function(t){var e,r,n,i,o,u,a;t==null&&(t={});e=t.prj;if(!e){return{}}r=this.voteMethod();n=this.pm.get(e);i=((this.data.cfg||{}).rule||{})["picked-count"];o=!!(i&&n.countTilRank>i);u=r==="t"?{overflow:o,picked:n.picked}:void 8;a=r==="t"?u.picked?u.overflow?"同分待議":"入選":"":void 8;return u.mark=a,u};l.voteMethod=function(){return((this.data.cfg||{}).rule||{}).base||"t"};l.active={};l.type="all";o.fire("init",{mod:l,submod:submod,ctx:r});return l.view=new ldview({root:e,initRender:false,init:{ldcv:l.tool.ldcv.view},handler:{"wake-lock-state":function(t){var e,r;e=t.node,r=t.views;return e.classList.toggle("on",l.wakeLock.query())},"show-group":function(t){var e;e=t.node;return e.classList.toggle("d-none",!((l.data.cfg||{}).group||{}).enabled)},"search-widget":l.tool.search.view,project:l.submod.project.view,"is-admin":function(t){var e;e=t.node;return e.classList.toggle("d-none",!l.isAdmin())},"ldcv-rule":l.submod.rule.view,"ldcv-monitor":l.submod.monitor.view,summary:function(t){var e,r;e=t.node;r=!in$(l.voteMethod(),(e.getAttribute("data-name")||"").split(","));return e.classList.toggle("d-none",r)},judge:{list:function(){return l.judge.users},key:function(t){return t.key},view:{text:{name:function(t){var e,r,n;e=t.node,r=t.ctx,n=t.ctxs;if(l.judge.form.config.anonymous){return"評審"+l.judge.users.indexOf(r)}else{return r.nickname||r.displayname}}}}},result:function(t){var e,r,n,i,o,u;e=t.node,r=t.ctx;n=l.submod.project.utils.filtered();i=n.filter(function(t){return l.pm.get(t).picked}).length;o=n.length;u=e.getAttribute("data-name");return e.innerText=u==="1"?i:u==="2"?o:o-i},"group-summary":{list:function(){var t,e;return(t=(e=l.brd.detail).group||(e.group={})).list||(t.list=[])},key:function(t){return t.slug},view:{text:{name:function(t){var e;e=t.ctx;return e.info.name}},handler:{result:function(t){var e,r,n,i,o,u;e=t.node,r=t.ctx;n=l.submod.project.utils.filtered();n=n.filter(function(t){return l.getGroup({prj:t}).slug===r.slug});i=n.filter(function(t){return l.pm.get(t).picked}).length;o=n.length;u=e.getAttribute("data-name");return e.innerText=u==="1"?i:u==="2"?o:o-i}}}},"all-sort":l.tool["all-sort"].view},action:{click:{"toggle-wake-lock":function(t){var e,r,n;e=t.node,r=t.views,n=t.evt;n.stopPropagation();return l.wakeLock.toggle().then(function(){return r[0].render("wake-lock-state")})},publish:function(){return i.ldcvmgr.get({name:"@grantdash/judge",path:"common/publishing.html"},{badge:"shortlisted"}).then(function(t){var e,r,n;if(!t){return}i.loader.on();e=l.voteMethod();r=l.submod.project.utils.filtered().map(function(t){var e;e=l.pm.get(t);return{key:+t.key,badge:e.picked}});n={prjs:r,badge:t};return debounce(1e3).then(function(){return l.publish(n)})["finally"](function(){return i.loader.off()}).then(function(){return i.ldcvmgr.get({name:"@grantdash/judge",path:"common/published.html"})})})},"toggle-order":function(){return l.tool.order.view()},"toggle-i18n":function(){return l.tool.i18n.view()},"toggle-group":function(){return l.tool.group.view()},"toggle-rule":function(){return l.ldcv.rule.toggle()},"toggle-monitor":function(){return l.ldcv.monitor.toggle()},"toggle-detail":function(){var r,u,t;r={customFields:function(t){var e,r;t==null&&(t={});if(!t.prj){return[{value:a("總票數"),key:"_總票數"},{value:a("結果"),key:"_結果"}]}e=l.pm.get(t.prj);r=l.resultMark({prj:t.prj});return[{value:e.ticket,key:"_總票數"},{value:r.mark,key:"_結果"}]},rank:function(t){var e;e=t.prj;return l.pm.get(e).rank},score:function(t){var e,r,n,i,o;e=t.judge,r=t.prj;return(((n=(i=l.data.user)[o=e.key]||(i[o]={})).prj||(n.prj={}))[r.key]||{}).v||0}};u={ns:"template/nwp-2024",name:"block",path:"ticket/detail.html"};t=function(t){var e,r,n,i,o;e=t.customFields,r=t.score,n=t.rank;return l.ldcvmgr.get(u,(i=(o={},o.brd=l.brd,o.grp=l.grp,o.prjs=l.prjs,o.judge=l.judge,o.data=l.data,o.lib=l.lib,o),i.score=r,i.customFields=e,i.rank=n,i))};t(r);return l.ldcvmgr.getcover(u).then(function(e){if((l.renders||(l.renders={}))["detail"]){return}return l.renders["detail"]=function(){var t;return e.fire("data",import$((t={},t.brd=l.brd,t.grp=l.grp,t.prjs=l.prjs,t.judge=l.judge,t.data=l.data,t.lib=l.lib,t),r))}})},"download-csv":function(){return l.submod.download.obj.run.apply(l,[{ctx:r,t:a}])}}}})})}};function import$(t,e){var r={}.hasOwnProperty;for(var n in e)if(r.call(e,n))t[n]=e[n];return t}function in$(t,e){var r=-1,n=e.length>>>0;while(++r<n)if(t===e[r])return true;return false}</script><div class="ldcv scroll" ld-scope="" ld="ldcv ldcv-rule" data-name="rule"><div class="base w-640 rwd"><div class="inner card shadow-sm" style="overflow:visible"><div class="card-body"><h3>規則設定</h3><p>在此設定入選的規則，例如，入選票數門檻，或入選標記的選擇規則。</p><hr><div class="mb-5"><div class="row"><div class="col-md"><div class="form-group"><label>票數配置 <span class="text-muted text-sm ml-1">/ 點數消耗方式</span></label><select class="form-control" ld="pt-ratio"><option value="linear">一票一點</option><option value="quad">平方耗點</option></select><div class="text-sm text-danger">． 預設為一票一點</div></div></div><div class="col-md"><div class="form-group"><label class="d-flex justify-content-between align-items-end"><span>評審配點</span></label><div class="d-flex align-items-center mb-1"><div class="input-group"><input class="form-control" ld="point-quota"><div class="input-group-append"><span class="input-group-text">點</span></div></div></div><div class="text-sm text-danger">． 為設定 0 或未填,則採用 1 點</div></div></div></div><div class="row"><div class="col-md"><div class="form-group"><label class="d-flex justify-content-between align-items-end"><span>票數上限</span></label><div class="d-flex align-items-center mb-1"><div class="input-group"><input class="form-control" ld="max-ticket"><div class="input-group-append"><span class="input-group-text">票</span></div></div></div><div class="text-sm text-danger">． 預設為 1 票</div></div></div><div class="col-md"><div class="form-group"><label class="d-flex justify-content-between align-items-end"><span>入選票數門檻</span><span class="text-sm text-muted" style="line-height:1.66em" ld="show-threshold-ticket">實際採用值: <span ld="threshold-ticket">0</span>票</span></label><div class="d-flex align-items-center"><div class="input-group"><div class="text-nowrap input-group-prepend"><span class="input-group-text">大於</span></div><input class="form-control" ld="threshold-ticket"><div class="input-group-append"><span class="input-group-text">票</span></div></div></div></div></div></div><div class="row"><div class="col-md"><div class="form-group"><label>組數上限</label><div class="d-flex align-items-center mb-1"><div class="input-group"><div class="text-nowrap input-group-prepend"><span class="input-group-text">最多</span></div><input class="form-control" ld="picked-count"><div class="input-group-append"><span class="input-group-text">組</span></div></div></div><div class="text-sm text-danger">． 0 表示無上限</div></div></div></div><br><label>評審相關</label><div class="border rounded p-3 d-flex flex-column g-3"><div class="d-flex align-items-center flex-wrap"><div class="flex-grow-1"><label class="mb-0">評審權重 <span class="text-sm text-muted">/ 目前 </span><span class="text-sm text-danger font-weight-bold" ld="weighted-value">未啟用</span></label><div class="text-muted text-sm">以加權方式計算評審票數</div></div><div class="mx-4"><div class="btn btn-sm btn-block btn-outline-secondary text-nowrap" ld="toggle-weighting">權重設定</div></div><div class="d-flex align-items-center"><div class="switch switch-lg" ld="switch" data-name="weighted"></div></div></div><div class="border-top"></div><div class="d-flex align-items-center flex-wrap"><div class="flex-grow-1"><label class="mb-0">評審評註選填 <span class="text-sm text-muted">/ 目前為 </span><span class="text-sm text-danger font-weight-bold" ld="comment-optional-value">必填</span></label><div class="text-muted text-sm">預設「必填」，開啟則改為「選填」</div></div><div class="d-flex align-items-center text-nowrap"><div class="switch switch-lg" ld="switch" data-name="comment-optional"></div></div></div></div></div><div class="text-right"><div class="btn btn-primary" data-ldcv-set="">完成</div></div></div></div></div></div><div class="ldcv scroll autogap" ld-scope="" ld="ldcv ldcv-monitor" data-name="monitor"><div class="base w-640 rwd"><div class="inner"><style type="text/css">.legend{line-height:1em;display:flex;align-items:center;margin-left:1em}.legend strong{font-weight:bold}.square{width:1em;height:.9em;border-radius:.25em;margin-right:.25em;display:inline-block}</style><script type="@plotdb/block">submod.monitor=function(t){var n,e,r,o=this;n=t.ctx;e=function(){return o.judge.users.map(function(e){var t,r;t={judge:e,value:r={}};o.prjs.map(function(t){var n;n=(((o.data.user||{})[e.key]||{}).prj||{})[t.key];if(n.avoid){return}r.count=(r.count||0)+1;if(n.comment){r.comment=(r.comment||0)+1}if(n.v!=null){return r.score=(r.score||0)+1}});return t})};r={handler:{judge:{list:function(){return e()},key:function(t){return t.judge.key},view:{text:{score:function(t){var n;n=t.ctx;return n.value.score||0},comment:function(t){var n;n=t.ctx;return n.value.comment||0},count:function(t){var n;n=t.ctx;return n.value.count||0},"used-point":function(t){var n;n=t.ctx;return((o.data.user||{})[n.judge.key]||{})["used-point"]||0},"total-point":function(t){var n;n=t.ctx;return((o.data.cfg||{}).rule||{})["point-quota"]||1}},handler:{name:function(t){var n,e;n=t.node,e=t.ctx;return n.innerText=e.judge.nickname||e.judge.displayname},"progress-point":function(t){var n,e,r,u;n=t.node,e=t.ctx;r=((o.data.user||{})[e.judge.key]||{})["used-point"]||0;u=((o.data.cfg||{}).rule||{})["point-quota"]||1;return n.style.width=100*r/u+"%"},"progress-comment":function(t){var n,e;n=t.node,e=t.ctx;return n.style.width=100*((e.value.comment||0)/(e.value.count||1))+"%"}}}}}};return{view:r}};</script><div class="text-center mb-4"><h3 class="mb-0">評選進度</h3></div><div class="mb-4"><div class="mb-4 clickable" ld-each="judge"><div class="d-flex justify-content-between"><div class="d-flex g-2 align-items-end"><div class="text-sm text-muted mr-1">委員</div><span ld="name"></span></div><div class="d-flex g-2"><div class="legend text-sm"><div class="square bg-primary"></div>已用點數: <strong ld="used-point">0</strong>/<strong ld="total-point">0</strong></div><div class="legend text-sm"><div class="square bg-success"></div>已評論: <strong ld="comment">0</strong>/<strong ld="count">0</strong></div></div></div><div class="d-flex g-2"><div class="progress flex-grow-1"><div class="progress-bar bg-primary" ld="progress-point" style="width:0%;transition:width .35s ease-in-out"></div></div><div class="progress flex-grow-1"><div class="progress-bar bg-success" ld="progress-comment" style="width:0%;transition:width .35s ease-in-out"></div></div></div></div></div><div class="text-right"><div class="btn btn-primary" data-ldcv-set="">關閉</div></div></div></div></div><div class="d-flex flex-column" style="overflow:scroll;flex:3 2 55%;width:55%"><div class="flex-grow-1 bg-white border-bottom"><div class="w-100"><div class="px-2 d-flex align-items-center bg-light sticky shadow-sm g-2 z-float" style="top:0;min-width:100%;width:fit-content;flex-wrap:nowrap;border-top:1px solid #eee;border-bottom:1px solid var(--secondary)"><div class="py-1 clickable text-center" t style="width:60px">No.</div><div class="py-1 clickable text-center" t style="width:60px">序位</div><div class="py-1 clickable text-center d-none" style="width:3.5em" ld="show-group"><span t>分組</span></div><div class="py-1 clickable text-center" t ld="sort" data-name="sid" style="width:80px">編號</div><div class="py-1 flex-grow-1 clickable" ld="sort" data-name="name" style="width:15em"><div class="input-group has-icon" ld-scope="" ld="search-widget"><input class="form-control form-control-sm" ld="keyword" t t-placeholder="searchhint"><div class="input-group-append" ld="search"><i class="i-close text-danger input-group-icon clickable" ld="clear"></i><div class="btn btn-sm btn-outline-secondary border"><i class="i-magnify" style="line-height:1em"></i></div></div></div></div><div class="py-1 text-right px-2 clickable d-none" t ld="show-budget sort" data-name="budget" style="width:50px">預算</div><div class="py-1 text-center" style="width:5em">總票數</div><div class="py-1 text-center" data-name="shortlist" style="width:3em"><span class="text-nowrap" t>入選標記</span></div><div class="text-center d-flex flex-column" style="flex:0 0 auto;align-self:stretch"><div class="d-flex judge-cells flex-grow-1"><div class="d-flex align-items-center" ld-each="judge" style="width:3em"><div class="w-100" ld="name" style="font-size:.85em;line-height:1em"></div></div></div></div><div class="py-1 text-center clickable" style="width:2.8em"><span t>會前加註</span></div><div class="py-1 text-center clickable" style="width:2.8em"><span t>會中加註</span></div><div class="py-1 text-center" style="width:3em"><span class="text-nowrap" t>迴避</span></div></div><div class="prj" ld-each="project"><div class="px-2 py-1 d-flex align-items-center border-bottom border-light g-2"><div class="text-center align-items-end justify-content-center text-nowrap pl-1 clickable" style="width:60px" ld="idx"></div><div class="text-center align-items-end justify-content-center text-nowrap pl-1 clickable" style="width:60px" ld="rank"><span ld="number"></span><span class="text-sm text-muted" ld="postfix"></span></div><div class="text-center clickable d-none" ld="show-group" style="width:3.5em"><div class="text-sm" ld="group"></div></div><div class="text-center clickable text-sm" style="width:80px" ld="custom-id"></div><div class="flex-grow-1" style="width:15em"><div class="text-underline clickable text-dark" ld="name" style="word-break:break-all"></div><div class="text-sm text-muted" ld="teamname"></div></div><div class="text-center font-weight-bold" style="width:5em" ld="ticket">0</div><div class="rounded text-center clickable py-1 final-result has-tips d-flex align-items-center justify-content-center" ld="result" style="width:3em;align-self:stretch;"><i ld="icon"></i><div class="hover-tip tip-sm tip-fit" t="同分待議"></div></div><div class="d-flex text-center judge-cells" style="flex:0 0 auto;align-self:stretch"><div ld-each="judge" style="width:3em"><div ld="ticket">0</div></div></div><div class="text-center clickable" ld="staff-note" data-type="prenote" style="width:2.8em"><i class="i-comment" ld="icon"></i></div><div class="text-center clickable" ld="staff-note" data-type="note" style="width:2.8em"><i class="i-comment" ld="icon"></i></div><div class="clickable text-center dropdown-toggle" data-toggle="dropdown" style="width:3em" ld="avoid">0</div></div></div></div></div><div class="py-2 px-3 d-flex text-nowrap sticky bg-white" style="bottom:0;left:0;right:0;box-shadow:0 -.12rem .25rem rgba(0,0,0,.07);width:fit-content;min-width:100%"><div class="flex-grow-1 d-flex align-items-center"><div class="d-none" ld="summary" data-name="t"><div class="d-flex"><div class="mr-1" t>入選</div><div class="mr-3 rounded-sm px-2 bg-success text-white" ld="result" data-name="1">0</div><div class="mr-1" t>未入選</div><div class="mr-2 rounded-sm px-2 bg-secondary text-white" ld="result" data-name="0">0</div><div ld="show-group"><div class="d-flex align-items-center h-100"><div class="mx-2 d-flex align-items-center text-sm" ld-each="group-summary"><div class="mr-1" ld="name"></div><div class="d-flex rounded-sm overflow-hidden text-white"><div class="bg-success px-1" ld="result" data-name="1">0</div><div class="bg-secondary px-1" ld="result" data-name="0">0</div></div></div></div></div></div></div><div class="d-none ml-2" ld="is-admin"><div class="btn btn-sm btn-outline-primary" t="發布" ld="publish"></div></div><div class="flex-grow-1 mx-2"></div><div class="d-none" ld="is-admin"><div class="d-flex g-2"><div class="dropup" ld="all-sort"><div class="btn btn-sm btn-outline-primary dropdown-toggle" ld="dropdown" data-toggle="dropdown"><span t>總表排序</span>: <span ld="all-sort-method-name"></span></div><div class="dropdown-menu dropdown-menu-right shadow-sm"><div class="dropdown-item" ld="all-sort-method" data-name="rank"><span t>序位</span> <i class="i-check"></i></div><div class="dropdown-item" ld="all-sort-method" data-name="id"><span t>編號</span> <i class="i-check"></i></div><div class="dropdown-item" ld="all-sort-method" data-name="custom-order"><span t>簡報順序</span> <i class="i-check"></i></div></div></div><div class="btn-group"><div class="btn btn-sm btn-outline-primary" t ld="toggle-monitor">評選進度</div><div class="btn btn-sm btn-outline-primary" t ld="toggle-detail">評分細節</div><div class="btn-group dropup"><div class="btn btn-sm btn-outline-primary dropdown-toggle" ld="dropdown" data-toggle="dropdown" t>設定項目</div><div class="dropdown-menu dropdown-menu-right shadow-sm" style="min-width:fit-content"><div class="dropdown-item" t ld="toggle-order">簡報順序</div><div class="dropdown-item" t ld="toggle-rule">規則設定</div><div class="dropdown-item" t ld="toggle-group">分組設定</div><div class="dropdown-item" t ld="toggle-i18n">翻譯設定</div><div class="dropdown-item align-items-center" ld="toggle-wake-lock"><span t>喚醒鎖</span><div class="ml-2 switch" ld="wake-lock-state"></div></div></div></div><div class="btn btn-sm btn-outline-primary" t ld="download-csv">下載 CSV</div></div></div></div></div></div></div><div class="d-none" style="flex:0 1 0%"><div class="card border shadow w-100 h-100" style="overflow:hidden;border-radius: .5em 0 0 .5em"><div class="card-body p-0"><iframe class="border-0 w-100 h-100" ld="iframe"></iframe><div class="w-100 h-100 vertical-center position-absolute z-float bg-light" ld="iframe-placeholder" style="top:0;left:0"><div class="w-100 text-center text-muted"><div class="text-lg" t>提案瀏覽區</div><div t>您可以點擊左方的提案名稱以在此瀏覽該提案內容</div></div></div><object class="w-100 h-100" data="" type="application/pdf"><embed src="" type="application/pdf"></object></div></div></div></div></div>
